---
title: "Simulation"
output: html_notebook
---

les simulations, basées sur la génération de nombres pseudo-aléatoires dans R, sont très utiles pour tester des idées en statistique. Le mieux est de l'appréhender en pratique avec un petit exemple simple.

Considérez le jet d'une pièce de monnaie en l'air. Répondez à la question suivante : à quelle vitesse obtient-on en moyenne FPP ou FPF ? est ce la même valeur ? 

Après combien de lancer va t'on obtenir F puis P puis P ? 

```{r}
set.seed(42)
# Je veux F P P 
# 1 = F
# 2 = P

a <- c("F","P")
n <- 10000
size <- 100

test <- function(a,n,size, sequence){
  res <- integer()
  i <- 1
  for( i in 1:n){
    x <- sample(a, size = size, replace = TRUE)
    x1 <- x
    y <- lead(x)
    z <- lead(y)
    x[x == sequence[1]] <- 0
    y[y == sequence[2]] <- 0
    z[z== sequence[3]] <- 0
    t <- x+y+z
    which(t == 0) -> test
    test[1] -> res[i]
    res
  }
  res
}

test(a = 1:2, n = 10000, size = 100, sequence = c(1,2,2)) -> a
mean(a)

test(a = 1:2, n = 10000, size = 100, sequence = c(1,2,1)) -> b
mean(b)

sequence <- c(1,2,1)
a <- 1:2
size <- 10000000

x <- sample(a, size = size, replace = TRUE)
x1 <- x
y <- lead(x)
z <- lead(y)
x[x == sequence[1]] <- 0
y[y == sequence[2]] <- 0
z[z== sequence[3]] <- 0
t <- x+y+z
which(t == 0) -> test
mean(diff(test)+2)


# Encore mieux

seek_sequence <- function(sequence, n){
  sample(c("F", "P"), n, replace = TRUE) %>.%
    paste(., collapse = "") %>.%
    gregexpr(sequence, .)[[1]] %>.%
    diff(.) %>.%
    mean(.) %>.%
    round(.)
}

seek_sequence(sequence = "FPP", n = 100000)

```

